
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://datashades.github.io/ckanext-files/cli/">
      
      
        <link rel="prev" href="../implementation-example/">
      
      
        <link rel="next" href="../api/">
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>CLI - ckanext-files</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cli" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ckanext-files" class="md-header__button md-logo" aria-label="ckanext-files" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ckanext-files
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CLI
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/DataShades/ckanext-files" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ckanext-files" class="md-nav__button md-logo" aria-label="ckanext-files" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    ckanext-files
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/DataShades/ckanext-files" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/configure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure the storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/use-in-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage in code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/use-in-browser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage in browser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/multi-storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/tracked-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tracked and untracked files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/permissions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Permissions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/ownership/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File ownership
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/transfer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ownership transfer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/task-queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Task queue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/capabilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Capabilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/multipart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multipart, resumable and signed uploads
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JavaScript utilities
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../upload-strategies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File upload strategies
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../implementation-example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example implementation of custom storage adapter
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    CLI
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    CLI
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adapters" class="md-nav__link">
    <span class="md-ellipsis">
      adapters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storages" class="md-nav__link">
    <span class="md-ellipsis">
      storages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stream-file_id" class="md-nav__link">
    <span class="md-ellipsis">
      stream FILE_ID
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scan" class="md-nav__link">
    <span class="md-ellipsis">
      scan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stats" class="md-nav__link">
    <span class="md-ellipsis">
      stats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owner" class="md-nav__link">
    <span class="md-ellipsis">
      owner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#types" class="md-nav__link">
    <span class="md-ellipsis">
      types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maintain" class="md-nav__link">
    <span class="md-ellipsis">
      maintain
    </span>
  </a>
  
    <nav class="md-nav" aria-label="maintain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#empty-owner" class="md-nav__link">
    <span class="md-ellipsis">
      empty-owner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invalid-owner" class="md-nav__link">
    <span class="md-ellipsis">
      invalid-owner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-files" class="md-nav__link">
    <span class="md-ellipsis">
      missing-files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrate" class="md-nav__link">
    <span class="md-ellipsis">
      migrate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="migrate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groups-storage_name" class="md-nav__link">
    <span class="md-ellipsis">
      groups STORAGE_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#users-storage_name" class="md-nav__link">
    <span class="md-ellipsis">
      users STORAGE_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-resources-storage_name" class="md-nav__link">
    <span class="md-ellipsis">
      local-resources STORAGE_NAME
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Internals
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Internals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shared/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shared
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../interfaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interfaces
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../configuration/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9" id="__nav_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/global/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../configuration/storage/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Storage configuration
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            Storage configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis storage configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/fs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filesystem storage configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/opendal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenDAL storage configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/libcloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apache libcloud storage configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../migration/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Migration(experimental)
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Migration(experimental)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../migration/group/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Group/organization images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../migration/user/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User avatars
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../migration/resource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resource uploads
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adapters" class="md-nav__link">
    <span class="md-ellipsis">
      adapters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storages" class="md-nav__link">
    <span class="md-ellipsis">
      storages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stream-file_id" class="md-nav__link">
    <span class="md-ellipsis">
      stream FILE_ID
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scan" class="md-nav__link">
    <span class="md-ellipsis">
      scan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stats" class="md-nav__link">
    <span class="md-ellipsis">
      stats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owner" class="md-nav__link">
    <span class="md-ellipsis">
      owner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#types" class="md-nav__link">
    <span class="md-ellipsis">
      types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maintain" class="md-nav__link">
    <span class="md-ellipsis">
      maintain
    </span>
  </a>
  
    <nav class="md-nav" aria-label="maintain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#empty-owner" class="md-nav__link">
    <span class="md-ellipsis">
      empty-owner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invalid-owner" class="md-nav__link">
    <span class="md-ellipsis">
      invalid-owner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-files" class="md-nav__link">
    <span class="md-ellipsis">
      missing-files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrate" class="md-nav__link">
    <span class="md-ellipsis">
      migrate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="migrate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groups-storage_name" class="md-nav__link">
    <span class="md-ellipsis">
      groups STORAGE_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#users-storage_name" class="md-nav__link">
    <span class="md-ellipsis">
      users STORAGE_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-resources-storage_name" class="md-nav__link">
    <span class="md-ellipsis">
      local-resources STORAGE_NAME
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="cli">CLI</h1>
<p>ckanext-files register <code>files</code> entrypoint under <code>ckan</code> command. Commands below
must be executed as <code>ckan -c $CKAN_INI files &lt;COMMAND&gt;</code>.</p>
<h2 id="adapters">adapters</h2>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>adapters
</code></pre></div>
</div>
<p>List all available storage adapters.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-v</code>/<code>--verbose</code></td>
<td>Include adapter's docstring</td>
</tr>
</tbody>
</table>
<h2 id="storages">storages</h2>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>storages
</code></pre></div>
</div>
<p>List all configured storages.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-v</code>/<code>--verbose</code></td>
<td>Include storage's capabilities</td>
</tr>
</tbody>
</table>
<h2 id="stream-file_id">stream FILE_ID</h2>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>stream<span class="w"> </span>b9483985-2681-4647-9b0f-f4acb4fd0fd3<span class="w"> </span>-o<span class="w"> </span>/tmp
</code></pre></div>
</div>
<p>Stream content of the file to STDOUT. For non-textual files use output
redirection <code>stream ID &gt; file.ext</code>. Alternatively, output destination can be
specified via <code>-o</code> option. If it contains path to directory, inside this
directory will be created file with the same name as streamed item. Otherwise,
<code>OUTPUT</code> is used as filename.</p>
<p><code>--start</code> and <code>--end</code> can be used to receive a fragment of the file. Only
positive values are guaranteed to work with any storage that supports
STREAM. Some storages support negative values for these options and count them
from the end of file. I.e <code>--start -10</code> reads last 10 bytes of file. <code>--end -1</code>
reads till the last byte, but the last byte is not included into output.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-o</code>/<code>--output</code></td>
<td>Stream into specified file or directory</td>
</tr>
<tr>
<td><code>--start</code></td>
<td>Start streaming from specified position</td>
</tr>
<tr>
<td><code>--end</code></td>
<td>End streaming at position</td>
</tr>
</tbody>
</table>
<h2 id="scan">scan</h2>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>scan
</code></pre></div>
</div>
<p>List all files that exist in storage. Works only if storage supports <code>SCAN</code>. By
default shows content of <code>default</code> storage. <code>-s/--storage-name</code> option changes
target storage.</p>
<p><code>-u/--untracked-only</code> flag shows only untracked files, that has no
corresponding record in DB. Can be used to identify leftovers after removing
data from portal.</p>
<p><code>-t/--track</code> flag registers any untracked file by creating DB record for
it. Can be used only when <code>ANALYZE</code> is supported. Files are created without an
owner. Use <code>-a/--adopt-by</code> option with user ID to give ownership over new files
to the specified user. Can be used when configuring a new storage connected to
existing location with files.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-s</code>/<code>--storage-name</code></td>
<td>Name of the target storage</td>
</tr>
<tr>
<td><code>-u</code>/<code>--untracked-only</code></td>
<td>Show only untracked files</td>
</tr>
<tr>
<td><code>-t</code>/<code>--track</code></td>
<td>Track every untracked file</td>
</tr>
<tr>
<td><code>-a</code>/<code>--adopt-by</code></td>
<td>Transfer every file affected by <code>-t</code> flag to specified user</td>
</tr>
</tbody>
</table>
<h2 id="stats">stats</h2>
<p>Group of commands for computing storage statistics.</p>
<h3 id="overview">overview</h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>stats<span class="w"> </span>overview
</code></pre></div>
</div>
<p>General information about storage usage.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-s</code>/<code>--storage-name</code></td>
<td>Name of the target storage</td>
</tr>
</tbody>
</table>
<h3 id="owner">owner</h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>stats<span class="w"> </span>owner
</code></pre></div>
</div>
<p>Files distribution by owner.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-s</code>/<code>--storage-name</code></td>
<td>Name of the target storage</td>
</tr>
</tbody>
</table>
<h3 id="types">types</h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>stats<span class="w"> </span>types
</code></pre></div>
</div>
<p>Files distribution by MIMEtype.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-s</code>/<code>--storage-name</code></td>
<td>Name of the target storage</td>
</tr>
<tr>
<td><code>-v</code>/<code>--verbose</code></td>
<td>Do not group records by owner ID instead of owner type</td>
</tr>
</tbody>
</table>
<h2 id="maintain">maintain</h2>
<p>Group of commands for storage maintenance.</p>
<h3 id="empty-owner">empty-owner</h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>maintain<span class="w"> </span>empty-owner<span class="w"> </span>--remove
</code></pre></div>
</div>
<p>Manage files that have no owner.</p>
<p>In normal workflow every file has an owner. Usually, unowned files appear after
performing <code>scan</code> with <code>--track</code> flag. Prefer transfering such files to an
owner or removing them.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-s</code>/<code>--storage-name</code></td>
<td>Name of the target storage</td>
</tr>
<tr>
<td><code>--remove</code></td>
<td>Remove all located files</td>
</tr>
</tbody>
</table>
<h3 id="invalid-owner">invalid-owner</h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>maintain<span class="w"> </span>invalid-owner<span class="w"> </span>--remove
</code></pre></div>
</div>
<p>Manage files that have owner details, but owner itself cannot be located.</p>
<p>There are no restrictions for owner type and ID values. It's possible to assign
absolutely any value to these attributes. But usually owner type refers to the
name of CKAN model, and owner ID refers to model's ID. ckanext-files can locate
owners that are specified in such way.</p>
<p>Extensions can use different logic, but in this case, they need to extend owner
location logic and explain, how custom owners can be found.</p>
<p>As result, if owner of file is specified but cannot be found, it means that
owner was removed from DB. Prefer transfering such files to a different owner
or removing them.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-s</code>/<code>--storage-name</code></td>
<td>Name of the target storage</td>
</tr>
<tr>
<td><code>--remove</code></td>
<td>Remove all located files</td>
</tr>
</tbody>
</table>
<h3 id="missing-files">missing-files</h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>maintain<span class="w"> </span>missing-files<span class="w"> </span>--remove
</code></pre></div>
</div>
<p>Manage files that do not exist in storage.</p>
<p>Such items appear when real file is removed from the storage manually. For
example, by running <code>rm -f /path/to/file</code> in case of <code>files:fs</code> storage.</p>
<p>These files must be removed from DB as well. Usually, there is no sense in
storing metadata of content that is no longer available.</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-s</code>/<code>--storage-name</code></td>
<td>Name of the target storage</td>
</tr>
<tr>
<td><code>--remove</code></td>
<td>Remove all located files</td>
</tr>
</tbody>
</table>
<h2 id="migrate">migrate</h2>
<p>Group of commands for migration from different storage implementations.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This is experimental command and migration process can change in the
stable release of ckanext-files.</p>
</div>
<h3 id="groups-storage_name">groups STORAGE_NAME</h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>migrate<span class="w"> </span>groups<span class="w"> </span>group_images
</code></pre></div>
</div>
<p>Migrate group images to specified storage.</p>
<h3 id="users-storage_name">users STORAGE_NAME</h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>migrate<span class="w"> </span>users<span class="w"> </span>user_images
</code></pre></div>
</div>
<p>Migrate user avatars to specified storage.</p>
<h3 id="local-resources-storage_name">local-resources STORAGE_NAME</h3>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code>ckan<span class="w"> </span>files<span class="w"> </span>migrate<span class="w"> </span>local-resources<span class="w"> </span>resources
</code></pre></div>
</div>
<p>Migrate resources uploaded via original ResourceUploader.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../implementation-example/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Example implementation of custom storage adapter">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Example implementation of custom storage adapter
              </div>
            </div>
          </a>
        
        
          
          <a href="../api/" class="md-footer__link md-footer__link--next" aria-label="Next: API">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                API
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.top", "content.code.copy", "content.code.select", "content.code.annotate", "navigation.footer", "navigation.indexes"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>